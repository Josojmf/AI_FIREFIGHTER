# .github/workflows/repo-health.yml
name: ðŸ©º Repository Health

on:
  schedule:
    - cron: '0 6 * * 1'  # Weekly health check
  workflow_dispatch:

jobs:
  repo-health:
    name: ðŸ” Health Check
    runs-on: ubuntu-latest
    continue-on-error: true  # âš ï¸ No bloqueante
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Repository health analysis
        run: |
          echo "## ðŸ©º Repository Health Report" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          
          # Check for large files
          echo "### ðŸ“ File Size Analysis" >> $GITHUB_STEP_SUMMARY
          find . -type f -size +5M -not -path "./.git/*" | head -5 | while read file; do
            size=$(du -h "$file" | cut -f1)
            echo "âš ï¸ Large file: $file ($size)" >> $GITHUB_STEP_SUMMARY
          done
          
          # Check for sensitive files
          echo "### ðŸ”’ Security Checks" >> $GITHUB_STEP_SUMMARY
          if find . -name "*.env" -o -name ".env.*" | grep -q "."; then
            echo "âŒ Found .env files (check if they should be ignored)" >> $GITHUB_STEP_SUMMARY
          else
            echo "âœ… No .env files found" >> $GITHUB_STEP_SUMMARY
          fi
          
          # Dependencies check
          echo "### ðŸ“¦ Dependencies Status" >> $GITHUB_STEP_SUMMARY
          if [ -f "requirements.txt" ]; then
            count=$(wc -l < requirements.txt)
            echo "âœ… Requirements.txt: $count dependencies" >> $GITHUB_STEP_SUMMARY
          fi

      - name: Check README
        run: |
          echo "### ðŸ“š Documentation Check" >> $GITHUB_STEP_SUMMARY
          if [ -f "README.md" ]; then
            readme_lines=$(wc -l < README.md)
            if [ "$readme_lines" -lt 10 ]; then
              echo "âš ï¸ README is very short ($readme_lines lines)" >> $GITHUB_STEP_SUMMARY
            else
              echo "âœ… README looks good ($readme_lines lines)" >> $GITHUB_STEP_SUMMARY
            fi
          else
            echo "âŒ No README.md found" >> $GITHUB_STEP_SUMMARY
          fi